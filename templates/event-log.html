<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>
        NFDI4DS | UHH-SEMS - Event Log
    </title>

    <link rel="shortcut icon" href="{{ url_for('static', filename='images/favicon.ico') }}" />

    <!-- <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/css/bootstrap.min.css" />
    <link rel="stylesheet" href="https://cdn.datatables.net/2.1.4/css/dataTables.bootstrap5.css" />
    <link rel="stylesheet" href="https://cdn.datatables.net/buttons/3.1.1/css/buttons.bootstrap5.css" />
    <link rel="stylesheet" href="https://cdn.datatables.net/staterestore/1.4.1/css/stateRestore.bootstrap5.css" /> -->

    <link rel="stylesheet" type="text/css"
        href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.1.3/css/bootstrap.min.css" />
    <link rel="stylesheet" type="text/css"
        href="https://cdn.datatables.net/v/bs5/jq-3.6.0/jszip-2.5.0/dt-1.12.1/b-2.2.3/b-html5-2.2.3/b-print-2.2.3/r-2.3.0/rg-1.2.0/datatables.min.css" />

    <script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.1.3/js/bootstrap.bundle.min.js"></script>
    <!-- <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.36/pdfmake.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.36/vfs_fonts.js"></script> -->
    <script type="text/javascript"
        src="https://cdn.datatables.net/v/bs5/jq-3.6.0/jszip-2.5.0/dt-1.12.1/b-2.2.3/b-html5-2.2.3/b-print-2.2.3/r-2.3.0/rg-1.2.0/datatables.min.js"></script>

</head>

<body>
    <div class="container table-responsive">
        <h1>Event Log</h1>
        <p>All the events will be listed here. Don't forget to investigate the root cause of errors.</p>
        <table id="example" class="display table-hover table-bordered table-sm" cellspacing="0" width="100%">
            <thead>
                <tr>
                    <th>timestamp</th>
                    <th class="all">id</th>
                    <th>type</th>
                    <th>filename</th>
                    <th>method</th>
                    <th>message</th>
                    <th>action</th>
                    <th class="none">traceback</th>
                </tr>
            </thead>
            <tfoot>
                <tr>
                    <th>timestamp</th>
                    <th class="all">id</th>
                    <th>type</th>
                    <th>filename</th>
                    <th>method</th>
                    <th>message</th>
                    <th>action</th>
                    <th class="none">traceback</th>
                </tr>
            </tfoot>
            <tbody>
                {% for event in events %}
                <tr>
                    <td>{{ event['_source']['timestamp'] }}</td>
                    <td>{{ event['_id'] }}</td>
                    <td>{{ event['_source']['type'] }}</td>
                    <td>{{ event['_source']['filename'] }}</td>
                    <td>{{ event['_source']['method'] }}</td>
                    <td>{{ event['_source']['message'] }}</td>
                    <td><a href="http://192.168.178.20:5002/delete-event/{{ event['_id'] }}" target="_blank">Delete</a>
                    </td>
                    <td>{{ event['_source']['traceback'] }}</td>
                </tr>
                {% endfor %}
            </tbody>

        </table>
    </div>


    <script>
        $(document).ready(function () {
            var table = new DataTable('#example', {
                columnDefs: [
                    {
                        targets: 7,
                        render: function (data, type, row) {
                            var d = $.fn.dataTable.render.text().display(data);
                            d = d.replaceAll('\n', '<br>');
                            return d;
                        }
                    }
                ]
            });
        });

        $.extend($.fn.dataTable.defaults, {
            responsive: true
        });
    </script>

</body>

</html>